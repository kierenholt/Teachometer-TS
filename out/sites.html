<html>
<head> 
	<meta charset="UTF-8"> 
	<link rel="stylesheet" type="text/css" href="style.css">
  <script src=assignment.js></script>
  <script async src="acorn_interpreter.js"></script>


<script>

    function init() {
		

        //settings
		//var settingsString = <?=settingsString?>; //NO QUOTES!!
        //alert("settingsString: "+settingsString);
		//settings = JSON.parse(settingsString);
        var internalSettings = {
        	"questionsDiv": document.getElementById("questionsDiv"),
            "allowRowDelete" : false,
        	  "allowRefresh" : false,
            "submitOnlyOnce" : false,
            "submitButtonText" : "check answers",
            "showRowTitles" : true,
            "allowGridlines" : false
        };

  		var markbookSettings = {
			"url" : "url2",
			"author" : "author2", 
			"score attempted questions only":"ON",
			"shuffle": "OFF",
			"truncate": -1,
			"check limit": 1,
			"time limit": -1,
			"truncate": -1,
			"journal mode": "OFF",
			"anticheat mode": "OFF",
      "allow refresh": "ON",
      "append stored responses": "ON"
			
        };
        markbookSettings.user = "<?=user?>";
        markbookSettings.workbookId = "<?=workbookId?>";
        markbookSettings.sheetName = "<?=sheetName?>";
        
        //responses
        
        var responsesString = `[
        	"1","2","2","1"
        	]`;
        if (responsesString) {
          markbookSettings.responses = JSON.parse(responsesString);
        }
        
        //rows
        var rowsString = `[{"purpose":"notes","leftRight":["left","right"],"title":"title","comment":"comment"},{"purpose":"notes","leftRight":["![](https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_272x92dp.png)\\n@[10,20](RELATIVE)","__"],"title":"relative container","comment":""},{"purpose":"question","leftRight":["\\n\\t\\t\\twhat colour is the sky ? A. red B. blue C. something else\\n\\t\\t\\twhat colour is the sky? ____\\n\\t\\t\\twhat colour is the sky? {red/green/blue}\\n\\t\\t\\t",""],"title":"question types - check correct columns are updated in markbook","comment":"B\\nblue\\nblue\\n"}]`;
        //markbookupdate
        var userRow = Number(2); //NO QUOTES!!!
        if (userRow > 0) {
          var markbookUpdateInjector = function(workbookId, sheetName, _userRow) {
            var workbookId = workbookId;
            var sheetName = sheetName;
            var userRow = _userRow;
        
            return function(markbookColumn, response, color, append, scoreOutOf) {
              					let str = (`${workbookId},${sheetName}
userRow:${userRow}
markbookColumn:${markbookColumn}
response:${response}
color: ${color}
append:  ${append}
score: ${scoreOutOf}`);
              					let shortstr = (`
markbookColumn:${markbookColumn} response:${response} append: ${append} score: ${scoreOutOf}`);
              //alert(str);
              document.getElementById("feedback").value += shortstr;
              
            };
          }
        
          markbookSettings.markbookUpdate = markbookUpdateInjector(markbookSettings.workbookId,markbookSettings.sheetName,userRow);
        };

		/*** CALL CONSTRUCTOR ***/
		window.assignment = new AssignmentHTML(internalSettings,markbookSettings);
		window.assignment.consumeRowsString(rowsString);

    }

</script>

</head>
<body onload="init()">
	 
	<br>
	<textarea id="feedback"></textarea>


  <div id="questionsDiv">
    </div>


</body>
</html>